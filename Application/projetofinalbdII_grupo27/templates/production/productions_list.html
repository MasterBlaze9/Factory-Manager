{% extends 'base.html' %} {% block content %}

<div
  class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center border-bottom"
>
  <h1 class="h2">Lista de produções</h1>
  <div class="btn-toolbar mb-2 mb-md-0">
    {% if user.is_staff %}
    <div class="">
      <a
        class="btn btn-primary my-4 float-end"
        href="{% url 'create_production' %}"
        >Criar nova produção</a
      >
      
    </div>
    {% endif %}
  </div>
</div>
{% if error_message %}
<div class="mt-3 mb-3">
  <h6 class="text-danger">{{ error_message }}</h6>
</div>
{% endif %}
<div class="pt-md-3">
  <table id="table-productions" class="table table-striped" style="width: 100%">
    <thead>
      <tr>
        <th>Id</th>
        <th>Nome</th>
        <th>Preço</th>
        <th>Fornecedor(es)</th>
        <th>Criado em</th>
        <th class="no-sort">Ações</th>
      </tr>
    </thead>
    <tbody>
      {% for row in productions_list %}
      <tr>
        <td>{{ row.0 }}</td>
        <td>{{ row.1|default:"-" }}</td>
        <td>{{ row.2|default:"-" }}€</td>
        <td>{{ row.3|default:"-" }}</td>
        <td>{{ row.4|date:"d-m-y H:m:s" }}</td>
        <td>
          <a
            class="btn btn-primary"
            href="{% url 'edit_production' row.0 %}"
            >Editar</a
          >
          <a
            class="btn btn-danger"
            href="{% url 'delete_production' row.0 %}"
            >Eliminar</a
          >
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- Modals -->
  
      </div>
    </div>
  </div>
  <!---->
</div>
{% endblock %} {% block extra_scripts %}
<script>
  $(document).ready(function () {
    $("#table-productions").DataTable({
      language: {
        url: "//cdn.datatables.net/plug-ins/1.13.7/i18n/pt-PT.json"
      },
      columnDefs: [
        {
          targets: "no-sort",
          orderable: false
        }
      ]
    });
  });

  document
    .getElementById("importComponentsFileInput")
    .addEventListener("change", function () {
      var allowedExtensions = /(\.json|\.xml)$/i;
      var fileInput = this;

      if (!allowedExtensions.test(fileInput.value)) {
        document
          .getElementById("divImportComponentsModalErrorMessage")
          .classList.remove("d-none");
        fileInput.value = "";
        document.getElementById("btnImportComponents").disabled = true;
      } else {
        document
          .getElementById("divImportComponentsModalErrorMessage")
          .classList.add("d-none");
        document.getElementById("btnImportComponents").disabled = false;
      }
    });
</script>
{% endblock %}
